<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ricerca Offerte</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="search-bg" style="background-image: linear-gradient(rgba(102, 126, 234, 0.8), rgba(118, 75, 162, 0.8)), url('attached_assets/stock_images/modern_office_or_pro_62ed6648.jpg');">

<div class="lang-selector">
  <button class="lang-btn active" data-lang="it" onclick="changeLanguage('it')">IT</button>
  <button class="lang-btn" data-lang="en" onclick="changeLanguage('en')">EN</button>
  <button class="lang-btn" data-lang="es" onclick="changeLanguage('es')">ES</button>
</div>

<section class="search-container">
  <div class="search-header">
    <h2 data-i18n="search_title">Ricerca Offerte di Lavoro</h2>
    <p>Personalizza i filtri per trovare la posizione perfetta in Europa</p>
  </div>

  <form id="searchForm" class="filter-grid">
    <div class="filter-item">
      <label for="country" data-i18n="country_label">Scegli il Paese:</label>
      <select id="country" name="country" required>
        <option value="">-- Seleziona --</option>
      </select>
    </div>

    <div class="filter-item">
      <label for="sector" data-i18n="sector_label">Scegli il Settore:</label>
      <select id="sector" name="sector" required>
        <option value="">-- Seleziona --</option>
      </select>
    </div>

    <div class="filter-item">
      <label for="zone" data-i18n="zone_label">Scegli la Zona:</label>
      <select id="zone" name="zone" required>
        <option value="">-- Prima seleziona un paese --</option>
      </select>
    </div>

    <button type="submit" class="btn btn-search" data-i18n="search_btn">Cerca Opportunit√†</button>
  </form>
</section>

<script src="js/lang.js?v=20250223"></script>
<script src="js/data.js?v=20250223"></script>

<footer>
  <div class="footer-content">
    <h3 data-i18n="legal_title">INFORMATIVA LEGALE</h3>
    <div class="legal-text" data-i18n="legal_content"></div>
  </div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', function() {
  populateCountries();
  populateSectors();
  
  const countrySelect = document.getElementById('country');
  countrySelect.addEventListener('change', populateZones);

  document.getElementById('searchForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const country = document.getElementById('country').value;
    const sector = document.getElementById('sector').value;
    const zone = document.getElementById('zone').value;

    const params = new URLSearchParams();
    if (country) params.append('country', country);
    if (sector) params.append('sector', sector);
    if (zone) params.append('zone', zone);

    window.location.href = 'results.html?' + params.toString();
  });

  // Carica lingua salvata
  let currentLang = localStorage.getItem("lang") || "it";
  loadLanguage(currentLang);
  updateActiveLangButton(currentLang);
});

function populateCountries() {
  const select = document.getElementById('country');
  countries.forEach(country => {
    const option = document.createElement('option');
    option.value = country;
    option.textContent = country;
    select.appendChild(option);
  });
}

function populateSectors() {
  const select = document.getElementById('sector');
  sectors.forEach(sector => {
    const option = document.createElement('option');
    option.value = sector;
    option.textContent = sector;
    select.appendChild(option);
  });
}

function populateZones() {
  const countrySelect = document.getElementById('country');
  const zoneSelect = document.getElementById('zone');
  const selectedCountry = countrySelect.value;

  // Pulisci le zone precedenti
  zoneSelect.innerHTML = '<option value="">-- Tutte le Zone --</option>';

  if (selectedCountry && zones[selectedCountry]) {
    zones[selectedCountry].forEach(zone => {
      const option = document.createElement('option');
      option.value = zone;
      option.textContent = zone;
      zoneSelect.appendChild(option);
    });
  }
}
</script>

</body>
</html>
